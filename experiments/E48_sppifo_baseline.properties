# =============================================================================
# E48: Fat-tree + SP-PIFO + No SRPT Baseline (100% Load) — No MIDST
# =============================================================================
# Realistic fat-tree (k=4, 32 servers) with ECMP routing + SP-PIFO scheduling.
# ALL flows use priority=0 (no SRPT) — realistic deployment.
# MIDST detection DISABLED — baseline for E49.
#
# Pure SP-PIFO: multi-queue scheduling only (no admission control).
# Without SRPT, all packets rank=0 → all go to Q0 → effectively FIFO.
# This is the scheduler that SHOULD benefit most from MIDST:
#   - No admission gate means no starvation risk
#   - MIDST penalty creates differentiation that's otherwise absent
#   - Detected bursty flows demoted to Q4 → non-bursty flows get Q0 priority
#
# Compare to: E49 (with MIDST), E44 (PACKS baseline no SRPT)
# =============================================================================

scenario_topology_file=example/topologies/fat_tree/fat_tree_k4.topology
scenario_topology_extend_with_servers=regular
scenario_topology_extend_servers_per_tl_node=4

seed=123
run_time_ns=1000000000

# TCP with NO SRPT: all flows use priority=0
transport_layer=tcp
network_device=ecmp_switch
network_device_routing=ecmp
network_device_intermediary=demo

link=perfect_simple
link_delay_ns=500
link_bandwidth_bit_per_ns=10

# Buffer: 150KB per port (same as E42/E43)
output_port_max_queue_size_bytes=150000

enable_generate_human_readable_flow_completion_log=true

# Lightweight logging
enable_inversions_tracking=true
enable_log_port_queue_state=false
traffic_flow_size_dist=pfabric_web_search_lower_bound

run_folder_name=e48_sppifo_baseline_no_srpt_fattree_100
run_folder_base_dir=temp/new_experiments/fattree

output_port=midst_feedback
midst_feedback_queue_type=new_sp_pifo

# MIDST detection DISABLED (impossibly high thresholds)
midst_sketch_size=256
midst_num_hash_functions=3
midst_high_watermark_packets=999999
midst_low_watermark_packets=999998
midst_burst_threshold=999999

# SP-PIFO multi-queue — SCALED FOR BYTE RANKS
midst_sppifo_num_queues=5
midst_sppifo_rank_delta=200000
midst_sppifo_congestion_penalty_rank=0

# Disable port-level VFL
midst_port_vfl_fraction=1.0

# 100% Load microburst traffic
traffic=microburst
microburst_steady_lambda=2000
microburst_burst_lambda=200000
microburst_fraction=10
microburst_burst_duration_ns=10000000
microburst_burst_interval_ns=40000000
